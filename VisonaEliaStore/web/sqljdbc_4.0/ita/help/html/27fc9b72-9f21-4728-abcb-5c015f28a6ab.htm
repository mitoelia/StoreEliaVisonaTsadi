<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Wrapper e interfacce</title><meta name="Language" content="it-it" /><meta name="Microsoft.Help.Id" content="27fc9b72-9f21-4728-abcb-5c015f28a6ab" /><meta name="Description" content="Microsoft JDBC Driver per SQL Server supporta le interfacce che consentono la creazione di un proxy di una classe e i wrapper che consentono di accedere alle estensioni dell'API JDBC specifiche di Microsoft JDBC Driver per SQL Server tramite un'interfaccia" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Wrapper e interfacce</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Microsoft JDBC Driver per SQL Server supporta le interfacce che consentono la creazione di un proxy di una classe e i wrapper che consentono di accedere alle estensioni dell'API JDBC specifiche di Microsoft JDBC Driver per SQL Server tramite un'interfaccia proxy.</p></div><h1 class="heading">Wrapper</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Microsoft JDBC Driver per SQL Server supporta l'interfaccia java.sql.Wrapper. Tale interfaccia fornisce un meccanismo per accedere alle estensioni dell'API JDBC specifiche di Microsoft JDBC Driver per SQL Server tramite un'interfaccia proxy.</p><p>Nell'interfaccia java.sql.Wrapper vengono definiti due metodi, ovvero <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> e <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span>. Il metodo <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> verifica se l'oggetto di input specificato implementa questa interfaccia. Il metodo <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> restituisce un oggetto che implementa questa interfaccia per consentire l'accesso ai metodi specifici di Microsoft JDBC Driver per SQL Server.</p><p>I metodi <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> e <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> vengono esposti come indicato di seguito:</p><ul><li><p><span sdata="link"><a href="71156863-3588-453e-b5a5-0573b2c1bebf.htm">Metodo isWrapperFor (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="cbbf2728-b8c8-4c35-875a-6e967c8285dc.htm">Metodo unwrap (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="09ed10eb-6e46-437b-a7c0-3c55574aad38.htm">Metodo isWrapperFor (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f5c9b734-2096-4ae4-a284-6b4d1b4a00d4.htm">Metodo unwrap (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f77af027-c021-4a17-b264-1ee592bfdd84.htm">Metodo isWrapperFor (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="eb8abe29-f3ec-4752-a590-1d5dc3e48f08.htm">Metodo unwrap (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="b0e591b1-73e2-4f90-967f-5555eadfc3f1.htm">Metodo isWrapperFor (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="8e3ec950-3ac1-4c28-9e97-ddce3bd46578.htm">Metodo unwrap (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="53f3291f-d43a-476b-a656-d86168dacf6c.htm">Metodo isWrapperFor (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="ce680176-ef04-4e44-bb6c-ec50bd06e7e6.htm">Metodo unwrap (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="d612461d-4c3f-46db-b968-ff4c80b2aa7c.htm">Metodo isWrapperFor (SQLServerXADataSource)</a></span></p></li><li><p><span sdata="link"><a href="d97c99b3-2224-4abb-8b32-40aff49fe759.htm">Metodo unwrap (SQLServerXADataSource)</a></span></p></li></ul></div><h1 class="heading">Interfacce</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>A partire dalla versione 3.0 del driver JDBC per SQL Server, sono disponibili interfacce che consentono a un server applicazioni di accedere a un metodo specifico del driver dalla classe associata. Il wrapping della classe può essere eseguito dal server applicazioni tramite la creazione di un proxy, esponendo la funzionalità specifica di Microsoft JDBC Driver per SQL Server da un'interfaccia. Il driver Microsoft JDBC Driver per SQL Server supporta le interfacce che includono costanti e metodi specifici di Microsoft JDBC Driver per SQL Server, per consentire a un server applicazioni di creare un proxy della classe.</p><p>Le interfacce derivano da interfacce Java standard ed è pertanto possibile utilizzare lo stesso oggetto dopo averne annullato il wrapping per accedere alla funzionalità specifica del driver o alla funzionalità generica di Microsoft JDBC Driver per SQL Server.</p><p>Sono state aggiunte le interfacce seguenti:</p><ul><li><p><a href="030a1631-cfcd-41e0-beb5-47f93c01e8e0.htm">ISQLServerCallableStatement</a></p></li><li><p><a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">ISQLServerConnection</a></p></li><li><p><a href="ba1d3242-19ca-4321-83fe-867a4f69f1d4.htm">ISQLServerDataSource</a></p></li><li><p><a href="cf87892e-5c34-4ac6-8258-c2a81e117b26.htm">ISQLServerPreparedStatement</a></p></li><li><p><a href="002496f7-8ec0-4267-b4e6-ba095e2ef306.htm">ISQLServerResultSet</a></p></li><li><p><a href="7f83b514-6e76-4f37-baf3-a10db2010e7c.htm">ISQLServerStatement</a></p></li></ul></div><h1 class="heading">Esempio</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><h1 class="heading">Descrizione</h1><div class="subsection"><p>In questo esempio viene illustrato come accedere a una funzione specifica di Microsoft JDBC Driver per SQL Server da un oggetto <b>DataSource</b>. Il wrapping della classe <b>DataSource</b> potrebbe essere stato eseguito da un server applicazioni. Per accedere alla costante o alla funzione specifica del driver JDBC è possibile annullare il wrapping dall'origine dei dati a un'interfaccia <b>ISQLServerDataSource</b> e utilizzare le funzioni dichiarate in questa interfaccia.</p></div><h1 class="heading">Codice</h1><div class="subsection"><div class="sampleCode"><span codeLanguage="other"><pre>import javax.sql.*;
import java.sql.*;
import com.microsoft.sqlserver.jdbc.*;

public class UnWrapTest {
   public static void main(String[] args) {
      // This is a test.  This DataSource object could be something from an appserver 
      // which has wrapped the real SQLServerDataSource with its own wrapper
      SQLServerDataSource ds = new SQLServerDataSource();
      checkSendStringParametersAsUnicode(ds);
   }

   // Unwrap to the ISQLServerDataSource interface to access the getSendStringParametersAsUnicode function
   static void checkSendStringParametersAsUnicode(DataSource ds) {
      try {
         final ISQLServerDataSource sqlServerDataSource = ds.unwrap(ISQLServerDataSource.class);
         boolean sendStringParametersAsUnicode = sqlServerDataSource.getSendStringParametersAsUnicode();

         System.out.println("Send string as parameter value is:-" + sendStringParametersAsUnicode);

      } catch (SQLException sqlE) {
         System.out.println("Exception:-" + sqlE);
      }
   }
}</pre></span></div></div></div><span id="seeAlsoSpan"><h1 class="heading">Vedere anche</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7802328d-4d23-4775-9573-4169b127d258.htm">Informazioni sui tipi di dati del driver JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Inviare <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/it-it/default.aspx.%0\A%0\d','Customer%20Feedback');">commenti e suggerimenti</a> su questo argomento a Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tutti i diritti sono riservati.</a></p></span></div></div></body></html>