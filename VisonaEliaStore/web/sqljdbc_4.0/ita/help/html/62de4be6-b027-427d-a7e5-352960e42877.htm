<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Supporto di Microsoft JDBC Driver per il ripristino di emergenza a disponibilità elevata</title><meta name="Language" content="it-it" /><meta name="Microsoft.Help.Id" content="62de4be6-b027-427d-a7e5-352960e42877" /><meta name="Description" content="In questo argomento viene illustrato il supporto di Microsoft JDBC Driver per SQL Server per il ripristino di emergenza a disponibilità elevata -- Gruppi di disponibilità AlwaysOn." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Supporto di Microsoft JDBC Driver per il ripristino di emergenza a disponibilità elevata</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>In questo argomento viene illustrato il supporto di Microsoft JDBC Driver per SQL Server per il ripristino di emergenza a disponibilità elevata -- Gruppi di disponibilità AlwaysOn. Per ulteriori informazioni su Gruppi di disponibilità AlwaysOn, vedere la documentazione online di SQL Server 2012.</p><p>A partire dalla versione 4.0 di Microsoft JDBC Driver per SQL Server è possibile specificare il listener di un gruppo di disponibilità (di ripristino di emergenza a disponibilità elevata) nella proprietà di connessione. Se un'applicazione Microsoft JDBC Driver per SQL Server è connessa a un database AlwaysOn soggetto a failover, la connessione originale viene interrotta e una nuova connessione deve essere aperta dall'applicazione per proseguire l'esecuzione dopo il failover.</p><p>Se non ci si connette al listener di un gruppo di disponibilità e più indirizzi IP sono associati a un server, viene effettuato un tentativo di connessione al primo indirizzo IP da parte di Microsoft JDBC Driver per SQL Server. Se Microsoft JDBC Driver per SQL Server non è in grado di stabilire una connessione con il primo indirizzo IP, la connessione non riesce. Tramite Microsoft JDBC Driver per SQL Server non verranno effettuati tentativi di connessione ad altri indirizzi IP successivi associati al server. Durante la connessione a un listener di un gruppo di disponibilità, viene effettuato un tentativo connessione a tutti gli indirizzi IP in parallelo da parte di Microsoft JDBC Driver per SQL Server e, se un tentativo riesce, vengono ignorati tutti gli altri tentativi di connessione in sospeso.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se si aumenta il timeout di connessione e si implementa la logica di ripetizione dei tentativi di connessione, vi è una maggiore probabilità di una connessione di un'applicazione a un gruppo di disponibilità. Poiché una connessione può non riuscire a causa di un failover del gruppo di disponibilità, è inoltre consigliabile implementare la logica di ripetizione dei tentativi di connessione, ritentando una connessione non riuscita fino alla riconnessione.</p></div><p>Le <a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">proprietà di connessione</a> seguenti sono state aggiunte in Microsoft JDBC Driver 4.0 per SQL Server:</p><ul><li><p><span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span></p></li><li><p><span sdata="langKeyword" value="applicationIntent"><span class="keyword">applicationIntent</span></span></p></li></ul></div><h1 class="heading">Connessione tramite MultiSubnetFailover</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Specificare sempre <span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span> per la connessione al listener di un gruppo di disponibilità di SQL Server 2012 o a un'istanza del cluster di failover di SQL Server 2012. <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> consente un failover più rapido per tutti i gruppi di disponibilità e le istanze del cluster di failover in SQL Server 2012 e riduce notevolmente i tempi di failover per topologie AlwaysOn su singole subnet o più subnet. Durante un failover su più subnet, verranno effettuati tentativi di connessione in parallelo da parte del client. Durante un failover su una subnet, tramite Microsoft JDBC Driver per SQL Server verranno effettuati ripetuti tentativi di connessione TCP in modo insistente.</p><p>La proprietà di connessione <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> indica che l'applicazione viene distribuita in un gruppo di disponibilità o in un'istanza del cluster di failover e che vengono effettuati tentativi di connessione da Microsoft JDBC Driver per SQL Server al database nell'istanza primaria di SQL Server tramite la connessione a tutti gli indirizzi IP. Quando si specifica <span sdata="langKeyword" value="MultiSubnetFailover=true"><span class="keyword">MultiSubnetFailover=true</span></span> per una connessione, i ripetuti tentativi di connessione TCP del client vengono eseguiti più rapidamente rispetto agli intervalli di ritrasmissione TCP predefiniti del sistema operativo. Ciò consente una riconnessione più rapida dopo il failover di un gruppo di disponibilità AlwaysOn o di un'istanza del cluster di failover AlwaysOn e si applica a gruppi di disponibilità e istanze del cluster di failover su singole subnet e su più subnet.</p><p>Per ulteriori informazioni sulle parole chiave della stringa di connessione in Microsoft JDBC Driver per SQL Server, vedere <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Impostazione delle proprietà delle connessioni</a></span>.</p><p>Se si specifica <span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span> durante la connessione a un elemento diverso dal listener di un gruppo di disponibilità o un'istanza del cluster di failover, le prestazioni possono risultare ridotte e questa impostazione non è supportata.</p><p>Se lo strumento di gestione della sicurezza non è installato, gli indirizzi IP virtuali vengono memorizzati nella cache di Java Virtual Machine per un periodo di tempo limitato definito, per impostazione predefinita, dall'implementazione JDK e dalle proprietà Java networkaddress.cache.ttl e networkaddress.cache.negative.ttl. Se lo strumento di gestione della sicurezza JDK è installato, gli indirizzi IP virtuali vengono memorizzati nella cache di Java Virtual Machine, ma la cache non viene aggiornata per impostazione predefinita. È consigliabile impostare "time-to-live" (networkaddress.cache.ttl) su un giorno per la cache di Java Virtual Machine. Se non si imposta il valore predefinito su un giorno (o un valore simile), il valore precedente non verrà eliminato dalla cache di Java Virtual Machine quando viene aggiunto o aggiornato un indirizzo IP virtuale. Per ulteriori informazioni su networkaddress.cache.ttl e networkaddress.cache.negative.ttl, vedere <a href="http://download.oracle.com/javase/6/docs/technotes/guides/net/properties.html">http://download.oracle.com/javase/6/docs/technotes/guides/net/properties.html</a>.</p><p>Utilizzare le linee guida seguenti per connettersi a un server in un gruppo di disponibilità o un'istanza del cluster di failover:</p><ul><li><p>Il driver genera un errore se la proprietà di connessione <span sdata="langKeyword" value="instanceName"><span class="keyword">instanceName</span></span> viene utilizzata nella stessa stringa di connessione della proprietà di connessione <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span>. Ciò riflette il fatto che SQL Browser non viene utilizzato in un gruppo di disponibilità. Se, tuttavia, si specifica anche la proprietà di connessione <span sdata="langKeyword" value="portNumber"><span class="keyword">portNumber</span></span>, la proprietà <span sdata="langKeyword" value="instanceName"><span class="keyword">instanceName</span></span> viene ignorata dal driver e viene utilizzata la proprietà <span sdata="langKeyword" value="portNumber"><span class="keyword">portNumber</span></span>.</p></li><li><p>Utilizzare la proprietà di connessione <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> per la connessione a una singola subnet o a più subnet, per ottenere prestazioni migliori per entrambe le connessioni.</p></li><li><p>Per connettersi a un gruppo di disponibilità, specificare il listener del gruppo di disponibilità come server nella stringa di connessione. Ad esempio, jdbc:sqlserver://VNN1.</p></li><li><p>La connessione a un'istanza di SQL Server configurata con più di 64 indirizzi IP provoca un errore di connessione.</p></li><li><p>Il comportamento di un'applicazione per cui viene utilizzata la proprietà di connessione <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> non dipende dal tipo di autenticazione, sia che si tratti di autenticazione di SQL Server, autenticazione Kerberos o autenticazione di Windows.</p></li><li><p>Aumentare il valore di <span sdata="langKeyword" value="loginTimeout"><span class="keyword">loginTimeout</span></span> in base al tempo di failover e in modo da ridurre i ripetuti tentativi di connessione dell'applicazione.</p></li><li><p>Le transazioni distribuite non sono supportate.</p></li></ul><p>Se il routing di sola lettura non è attivato, la connessione a un percorso di replica secondaria in un gruppo di disponibilità non riuscirà nei casi seguenti:</p><ol><li><p>Il percorso della replica secondaria non è configurato per accettare connessioni.</p></li><li><p>Per una applicazione si utilizza <span sdata="langKeyword" value="applicationIntent=ReadWrite"><span class="keyword">applicationIntent=ReadWrite</span></span> (vedere di seguito) e il percorso della replica secondaria è configurato per l'accesso di sola lettura.</p></li></ol><p>Una connessione non riesce se una replica primaria è configurata per rifiutare carichi di lavoro di sola lettura e la stringa di connessione contiene <span sdata="langKeyword" value="ApplicationIntent=ReadOnly"><span class="keyword">ApplicationIntent=ReadOnly</span></span>.</p></div><h1 class="heading">Aggiornamento per l'utilizzo di cluster su più subnet dal mirroring di database</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Se si aggiorna un'applicazione Microsoft JDBC Driver per SQL Server che utilizza il mirroring di database in uno scenario su più subnet, è consigliabile rimuovere la proprietà di connessione <span sdata="langKeyword" value="failoverPartner"><span class="keyword">failoverPartner</span></span> e sostituirla con <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> impostata su <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, nonché sostituire il nome del server nella stringa di connessione con un listener di un gruppo di disponibilità. Se in una stringa di connessione vengono utilizzate le proprietà <span sdata="langKeyword" value="failoverPartner"><span class="keyword">failoverPartner</span></span> e <span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span>, il driver genererà un errore. Se, tuttavia, in una stringa di connessione vengono utilizzate le proprietà <span sdata="langKeyword" value="failoverPartner"><span class="keyword">failoverPartner</span></span> e <span sdata="langKeyword" value="multiSubnetFailover=false"><span class="keyword">multiSubnetFailover=false</span></span> (o <span sdata="langKeyword" value="ApplicationIntent=ReadWrite"><span class="keyword">ApplicationIntent=ReadWrite</span></span>), l'applicazione utilizzerà il mirroring di database.</p><p>Il driver restituirà un errore se il mirroring di database viene utilizzato nel database primario nel gruppo di disponibilità e se si utilizza <span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span> nella stringa di connessione tramite cui viene eseguita la connessione a un database primario anziché a un listener del gruppo di disponibilità.</p></div><h1 class="heading">Definizione delle finalità dell'applicazione</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Se <span sdata="langKeyword" value="applicationIntent=ReadOnly"><span class="keyword">applicationIntent=ReadOnly</span></span>, tramite il client viene richiesto un carico di lavoro di sola lettura durante la connessione a un database abilitato per AlwaysOn. Le finalità verranno applicate dal server in fase di connessione e durante un istruzione di database USE, ma solo a un database abilitato per AlwaysOn.</p><p>La parola chiave <span sdata="langKeyword" value="applicationIntent"><span class="keyword">applicationIntent</span></span> non può essere utilizzata con database di sola lettura legacy.</p><p>Un database può consentire o non consentire carichi di lavoro di lettura nel database AlwaysOn di destinazione. A tale scopo, viene utilizzata la clausola <span sdata="langKeyword" value="ALLOW_CONNECTIONS"><span class="keyword">ALLOW_CONNECTIONS</span></span> delle istruzioni Transact-SQL <span sdata="langKeyword" value="PRIMARY_ROLE"><span class="keyword">PRIMARY_ROLE</span></span> e <span sdata="langKeyword" value="SECONDARY_ROLE"><span class="keyword">SECONDARY_ROLE</span></span>.</p><p>La parola chiave <span sdata="langKeyword" value="applicationIntent"><span class="keyword">applicationIntent</span></span> viene utilizzata per abilitare il routing di sola lettura.</p></div><h1 class="heading">Routing di sola lettura</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Il routing di sola lettura è una funzionalità che può garantire la disponibilità di una replica di sola lettura di un database. Per abilitare il routing di sola lettura:</p><ol><li><p>È necessario connettersi a un listener di un gruppo di disponibilità AlwaysOn.</p></li><li><p>La parola chiave della stringa di connessione <span sdata="langKeyword" value="applicationIntent"><span class="keyword">applicationIntent</span></span> deve essere impostata su <span sdata="langKeyword" value="ReadOnly"><span class="keyword">ReadOnly</span></span>.</p></li><li><p> Il gruppo di disponibilità deve essere configurato dall'amministratore del database in modo che consenta il routing di sola lettura.</p></li></ol><p>È possibile che non tutte le diverse connessioni che utilizzano il routing di sola lettura consentano la connessione alla stessa replica di sola lettura. Le modifiche apportate nella sincronizzazione del database o nella configurazione del routing del server possono produrre connessioni client a repliche di sola lettura diverse. Per fare in modo che tutte le richieste di sola lettura eseguano la connessione alla stessa replica di sola lettura, non passare un listener di un gruppo di disponibilità o un indirizzo IP virtuale alla parola chiave della stringa di connessione <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span>. Specificare invece il nome dell'istanza di sola lettura.</p><p>Per il routing di sola lettura può essere necessario più tempo rispetto alla connessione alla replica primaria, in quanto viene innanzitutto eseguita la connessione alla replica primaria e quindi viene individuata la miglior replica secondaria leggibile disponibile. Per questo motivo, è consigliabile aumentare il timeout di accesso.</p></div><h1 class="heading">Nuovi metodi che supportano multiSubnetFailover e applicationIntent</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>I metodi seguenti forniscono accesso programmatico alle parole chiave della stringa di connessione <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> e <span sdata="langKeyword" value="applicationIntent"><span class="keyword">applicationIntent</span></span>:</p><ul><li><p><a href="19411e6c-c456-4533-8252-54569a2a6b1f.htm">SQLServerDataSource.getApplicationIntent</a></p></li><li><p><a href="e164c8ac-a0ae-4638-affb-ed454e7c0708.htm">SQLServerDataSource.setApplicationIntent</a></p></li><li><p><a href="1e8cb175-5f4c-4208-b4f5-3646990a30e3.htm">SQLServerDataSource.getMultiSubnetFailover</a></p></li><li><p><a href="7ffd282d-c2f6-4d1b-a7a6-859d18b388aa.htm">SQLServerDataSource.setMultiSubnetFailover</a></p></li><li><p><a href="b5eaad8a-31ef-44ac-af11-d5caa13ac3e2.htm">SQLServerDriver.getPropertyInfo</a></p></li></ul><p>I metodi <span sdata="langKeyword" value="getMultiSubnetFailover"><span class="keyword">getMultiSubnetFailover</span></span>, <span sdata="langKeyword" value="setMultiSubnetFailover"><span class="keyword">setMultiSubnetFailover</span></span>, <span sdata="langKeyword" value="getApplicationIntent"><span class="keyword">getApplicationIntent</span></span> e <span sdata="langKeyword" value="setApplicationIntent"><span class="keyword">setApplicationIntent</span></span> vengono inoltre aggiunti a <span sdata="link"><a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">Classe SQLServerDataSource</a></span>, <span sdata="link"><a href="b00e5a90-2af7-4d04-8ef8-256183777dcf.htm">Classe SQLServerConnectionPoolDataSource</a></span> e <span sdata="link"><a href="95fc7b07-2498-4a7e-8f7f-ee0d86b598b4.htm">Classe SQLServerXADataSource</a></span>.</p></div><h1 class="heading">Convalida del certificato SSL</h1><div id="sectionSection5" class="section" name="collapseableSection" style=""><p>Un gruppo di disponibilità è costituito da più server fisici. In Microsoft JDBC Driver 4.0 per SQL Server è stato aggiunto il supporto per <span sdata="langKeyword" value="Subject Alternate Name"><span class="keyword">Subject Alternate Name</span></span> in certificati SSL in modo che più host possano essere associati allo stesso certificato. Per ulteriori informazioni su SSL, vedere <span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">Informazioni sul supporto SSL</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Vedere anche</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Impostazione delle proprietà delle connessioni</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">Connessione a SQL Server con il driver JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Inviare <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/it-it/default.aspx.%0\A%0\d','Customer%20Feedback');">commenti e suggerimenti</a> su questo argomento a Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tutti i diritti sono riservati.</a></p></span></div></div></body></html>