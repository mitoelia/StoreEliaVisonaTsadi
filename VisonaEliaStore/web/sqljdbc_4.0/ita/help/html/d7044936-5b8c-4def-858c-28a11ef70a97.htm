<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilizzo di tipi di dati di base</title><meta name="Language" content="it-it" /><meta name="System.Keywords" content="tipi di dati di base" /><meta name="Microsoft.Help.Id" content="d7044936-5b8c-4def-858c-28a11ef70a97" /><meta name="Description" content="In Microsoft JDBC Driver per SQL Server vengono utilizzati i tipi di dati JDBC di base per convertire i tipi di dati di SQL Server in un formato comprensibile nel linguaggio di programmazione Java e viceversa." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilizzo di tipi di dati di base</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>In Microsoft JDBC Driver per SQL Server vengono utilizzati i tipi di dati JDBC di base per convertire i tipi di dati di SQL Server in un formato comprensibile nel linguaggio di programmazione Java e viceversa. Il driver JDBC fornisce supporto per l'API di JDBC 4.0, che include il tipo di dati <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span> e i tipi di dati National (Unicode), quali <span sdata="langKeyword" value="NCHAR"><span class="keyword">NCHAR</span></span>, <span sdata="langKeyword" value="NVARCHAR"><span class="keyword">NVARCHAR</span></span>, <span sdata="langKeyword" value="LONGNVARCHAR"><span class="keyword">LONGNVARCHAR</span></span> e <span sdata="langKeyword" value="NCLOB"><span class="keyword">NCLOB</span></span>.</p></div><h1 class="heading">Mapping di tipi di dati</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Nella tabella seguente sono elencati i mapping predefiniti tra i tipi di dati di base di SQL Server, JDBC e del linguaggio di programmazione Java:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Tipi di SQL Server</p></th><th><p>Tipi JDBC (java.sql.Types)</p></th><th><p>Tipi del linguaggio Java</p></th></tr><tr><td><p>bigint</p></td><td><p>BIGINT</p></td><td><p>long</p></td></tr><tr><td><p>binary</p></td><td><p>BINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p>bit</p></td><td><p>BIT</p></td><td><p>boolean</p></td></tr><tr><td><p>char</p></td><td><p>CHAR</p></td><td><p>String</p></td></tr><tr><td><p>date</p></td><td><p>DATE</p></td><td><p>java.sql.Date</p></td></tr><tr><td><p>datetime</p></td><td><p>TIMESTAMP</p></td><td><p>java.sql.Timestamp</p></td></tr><tr><td><p>datetime2</p></td><td><p>TIMESTAMP</p></td><td><p>java.sql.Timestamp</p></td></tr><tr><td><p>datetimeoffset (2)</p></td><td><p>microsoft.sql.Types.DATETIMEOFFSET</p></td><td><p>microsoft.sql.DateTimeOffset</p></td></tr><tr><td><p>decimal</p></td><td><p>DECIMAL</p></td><td><p>java.math.BigDecimal</p></td></tr><tr><td><p>float</p></td><td><p>DOUBLE</p></td><td><p>double</p></td></tr><tr><td><p>image</p></td><td><p>LONGVARBINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p>int</p></td><td><p>INTEGER</p></td><td><p>int</p></td></tr><tr><td><p>money</p></td><td><p>DECIMAL</p></td><td><p>java.math.BigDecimal</p></td></tr><tr><td><p>nchar</p></td><td><p>CHAR</p><p>NCHAR (Java SE 6.0)</p></td><td><p>String</p></td></tr><tr><td><p>ntext</p></td><td><p>LONGVARCHAR</p><p>LONGNVARCHAR (Java SE 6.0)</p></td><td><p>String</p></td></tr><tr><td><p>numeric</p></td><td><p>NUMERIC</p></td><td><p>java.math.BigDecimal</p></td></tr><tr><td><p>nvarchar</p></td><td><p>VARCHAR</p><p>NVARCHAR (Java SE 6.0)</p></td><td><p>String</p></td></tr><tr><td><p>nvarchar(max)</p></td><td><p>VARCHAR</p><p>NVARCHAR (Java SE 6.0)</p></td><td><p>String</p></td></tr><tr><td><p>real</p></td><td><p>REAL</p></td><td><p>float</p></td></tr><tr><td><p>smalldatetime</p></td><td><p>TIMESTAMP</p></td><td><p>java.sql.Timestamp</p></td></tr><tr><td><p>smallint</p></td><td><p>SMALLINT</p></td><td><p>short</p></td></tr><tr><td><p>smallmoney</p></td><td><p>DECIMAL</p></td><td><p>java.math.BigDecimal</p></td></tr><tr><td><p>text</p></td><td><p>LONGVARCHAR</p></td><td><p>String</p></td></tr><tr><td><p>time</p></td><td><p>TIME (1)</p></td><td><p>java.sql.Time (1)</p></td></tr><tr><td><p>timestamp</p></td><td><p>BINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p>tinyint</p></td><td><p>TINYINT</p></td><td><p>short</p></td></tr><tr><td><p>udt</p></td><td><p>VARBINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p>uniqueidentifier</p></td><td><p>CHAR</p></td><td><p>String</p></td></tr><tr><td><p>varbinary</p></td><td><p>VARBINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p>varbinary(max)</p></td><td><p>VARBINARY</p></td><td><p>byte[]</p></td></tr><tr><td><p /></td><td><p /></td><td><p /></td></tr><tr><td><p>varchar</p></td><td><p>VARCHAR</p></td><td><p>String</p></td></tr><tr><td><p>varchar(max)</p></td><td><p>VARCHAR</p></td><td><p>String</p></td></tr><tr><td><p>xml</p></td><td><p>LONGVARCHAR</p><p>LONGNVARCHAR (Java SE 6.0)</p></td><td><p>String</p><p>SQLXML</p></td></tr></table></div><p>(1) Per utilizzare java.sql.Time con il tipo time di SQL Server, è necessario impostare la proprietà di connessione <span sdata="langKeyword" value="sendTimeAsDatetime"><span class="keyword">sendTimeAsDatetime</span></span> su false.</p><p>(2) È possibile accedere a livello di codice ai valori di <span sdata="langKeyword" value="datetimeoffset"><span class="keyword">datetimeoffset</span></span> con <span sdata="link"><a href="20bbeacd-ccca-4a46-8184-ff941ae2ec5f.htm">Classe DateTimeOffset</a></span>.</p><p>Il tipo di dati sqlvariant di SQL Server non è attualmente supportato dal driver JDBC. Se si utilizza una query per recuperare dati da un tabella contenente una colonna con il tipo di dati sqlvariant, verrà generata un'eccezione.</p><p>Nelle sezioni seguenti vengono forniti esempi di come sia possibile utilizzare il driver JDBC e i tipi di dati di base. Per un esempio più dettagliato dell'utilizzo dei tipi di dati di base in un'applicazione Java, vedere <span sdata="link"><a href="59ac80cf-fc66-4493-933d-38e479c5f54d.htm">Esempio di tipi di dati di base</a></span>.</p></div><h1 class="heading">Recupero di dati in forma di stringa</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Se è necessario recuperare dati da un'origine dei dati con mapping a uno qualsiasi dei tipi di dati JDBC di base, per visualizzarli come stringa, o se non sono richiesti dati fortemente tipizzati, è possibile utilizzare il metodo <a href="f81dde01-d328-4b32-8871-1efac645b68e.htm">getString</a> della classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>, come nell'esempio seguente:</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>String SQL = "SELECT TOP 10 * FROM Person.Contact";
Statement stmt = con.createStatement();
ResultSet rs = stmt.executeQuery(SQL);

while (rs.next()) {
   System.out.println(rs.getString(4) + " " + rs.getString(6));
}
rs.close();
stmt.close();

</pre></span></div></div></div><h1 class="heading">Recupero di dati per tipo di dati</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Se è necessario recuperare dati di cui si conosce il tipo da un'origine dati, utilizzare uno dei metodi <b>get&lt;Type&gt;</b> della classe <b>SQLServerResultSet</b>, noti anche come <span class="term">metodi per il richiamo</span>. Con i metodi <b>get&lt;Type&gt;</b> è possibile utilizzare un nome o un indice di colonna, come nell'esempio seguente:</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>ResultSet rs = stmt.executeQuery("SELECT lname, job_id FROM employee
   WHERE (lname = 'Brown')");
rs.next();
short empJobID = rs.getShort("job_id");
rs.close();
stmt.close();

</pre></span></div></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>I metodi con scala <b>getUnicodeStream</b> e <b>getBigDecimal</b> sono deprecati e non sono supportati dal driver JDBC.</p></div></div><h1 class="heading">Aggiornamento di dati per tipo di dati</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Se è necessario aggiornare il valore di un campo in un'origine dati, utilizzare uno dei metodi <b>update&lt;Type&gt;</b> della classe <b>SQLServerResultSet</b>. Nell'esempio seguente il metodo <a href="2bb0319e-12cb-4604-a7e3-b22a24b02296.htm">updateInt</a> viene utilizzato insieme al metodo <a href="cfced0ca-a281-40dc-8d2f-370d5f0bf12b.htm">updateRow</a> per aggiornare i dati nell'origine dati:</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE); 
ResultSet rs = stmt.executeQuery("SELECT lname, job_id FROM employee
   WHERE (lname = 'Brown')");
rs.next();
short empJobID = rs.getInt(2);
empJobID++;
rs.first();
rs.updateInt(2, empJobID);
rs.updateRow();
rs.close();
stmt.close();

</pre></span></div></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Il driver JDBC non è in grado di aggiornare una colonna SQL Server il cui nome contiene più di 127 caratteri. Se si tenta di aggiornare una colonna il cui nome contiene più di 127 caratteri, verrà generata un'eccezione.</p></div></div><h1 class="heading">Aggiornamento di dati mediante query con parametri</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Se è necessario aggiornare dati in un'origine dati utilizzando una query con parametri, è possibile impostare il tipo di dati dei parametri utilizzando uno dei metodi <b>set&lt;Type&gt;</b> della classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>, noti anche come <span class="term">metodi per l'impostazione</span>. Nell'esempio seguente viene utilizzato il metodo <a href="bd4e4085-f704-4a73-b6a7-7d443d564728.htm">prepareStatement</a> per precompilare la query con parametri, quindi viene utilizzato il metodo <a href="25dabdc9-c60f-485a-87eb-306067964765.htm">setString</a> per impostare il valore stringa del parametro prima di chiamare il metodo <a href="ca534c6b-ef4d-4ae8-8cc3-514728623cff.htm">executeUpdate</a>.</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>PreparedStatement pstmt = con.prepareStatement("UPDATE employee SET
   fname = ? WHERE (lname = 'Brown')");
String first = "Bob";
pstmt.setString(1, first);
int rowCount = pstmt.executeUpdate();
pstmt.close();

</pre></span></div></div><p>Per ulteriori informazioni sulle query con parametri, vedere <span sdata="link"><a href="3202b88f-ce13-44dd-982c-c6a3b0260378.htm">Utilizzo di istruzioni SQL con parametri</a></span>.</p></div><h1 class="heading">Passaggio di parametri a una stored procedure</h1><div id="sectionSection5" class="section" name="collapseableSection" style=""><p>Se è necessario passare parametri tipizzati in una stored procedure, è possibile impostare i parametri in base all'indice o al nome utilizzando uno dei metodi <b>set&lt;Type&gt;</b> della classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>. Nell'esempio seguente viene utilizzato il metodo <a href="265b024c-898a-4bd0-98b5-f06076717b9e.htm">prepareCall</a> per impostare la chiamata alla stored procedure, quindi viene utilizzato il metodo <a href="f38b97b5-d4f0-4f74-a33d-740241a85842.htm">setString</a> per impostare il parametro per la chiamata prima di chiamare il metodo <a href="599cf463-e19f-4baa-bacb-513cad7c6cd8.htm">executeQuery</a>. </p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>CallableStatement cstmt = con.prepareCall("{call employee_jobid(?)}");
String lname = "Brown";
cstmt.setString(1, lname);
Resultset rs = cstmt.executeQuery();
rs.close();
cstmt.close();

</pre></span></div></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>In questo esempio viene restituito un set di risultati con i risultati dell'esecuzione della stored procedure. </p></div><p>Per ulteriori informazioni sull'utilizzo del driver JDBC con stored procedure e parametri di input, vedere <span sdata="link"><a href="8f491b70-7d1b-42bd-964f-9a8b86af5eaa.htm">Utilizzo di una stored procedure con parametri di input</a></span>.</p></div><h1 class="heading">Recupero di parametri da una stored procedure</h1><div id="sectionSection6" class="section" name="collapseableSection" style=""><p>Se è necessario recuperare parametri da una stored procedure, occorre innanzitutto registrare un parametro OUT in base al nome o all'indice, utilizzando il metodo <a href="82f8d608-efc1-4af8-a985-ec25d19420aa.htm">registerOutParameter</a> della classe <b>SQLServerCallableStatement</b>, e quindi assegnare il parametro OUT restituito a una variabile appropriata, dopo aver eseguito la chiamata alla stored procedure. Nell'esempio seguente viene utilizzato il metodo <b>prepareCall</b> per impostare la chiamata alla stored procedure, quindi viene utilizzato il metodo <b>registerOutParameter</b> per impostare il parametro OUT e infine viene utilizzato il metodo <a href="f38b97b5-d4f0-4f74-a33d-740241a85842.htm">setString</a> per impostare il parametro per la chiamata prima di chiamare il metodo <b>executeQuery</b>. Il valore restituito dal parametro OUT della stored procedure viene recuperato utilizzando il metodo <a href="9e3c51bc-7285-4f28-92c8-cfa05e49da9e.htm">getShort</a>.</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>CallableStatement cstmt = con.prepareCall("{call employee_jobid (?, ?)}");
cstmt.registerOutParameter(2, java.sql.Types.SMALLINT);
String lname = "Brown";
cstmt.setString(1, lname);
Resultset rs = cstmt.executeQuery();
short empJobID = cstmt.getShort(2);
rs.close();
cstmt.close();

</pre></span></div></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Oltre al parametro out, può essere restituito anche un set di risultati con i risultati dell'esecuzione della stored procedure.</p></div><p>Per ulteriori informazioni su come utilizzare il driver JDBC con stored procedure e parametri di output, vedere <span sdata="link"><a href="1c006f27-7e99-43d5-974c-7b782659290c.htm">Utilizzo di una stored procedure con parametri di output</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Vedere anche</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7802328d-4d23-4775-9573-4169b127d258.htm">Informazioni sui tipi di dati del driver JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Inviare <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/it-it/default.aspx.%0\A%0\d','Customer%20Feedback');">commenti e suggerimenti</a> su questo argomento a Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tutti i diritti sono riservati.</a></p></span></div></div></body></html>