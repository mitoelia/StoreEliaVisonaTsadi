<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Esecuzione di operazioni batch</title><meta name="Language" content="it-it" /><meta name="System.Keywords" content="operazioni batch" /><meta name="Microsoft.Help.Id" content="1a576d95-7da6-4b7b-8b32-59e5b4d354c4" /><meta name="Description" content="Per garantire prestazioni migliori quando si eseguono più aggiornamenti di un database di SQL Server, Microsoft JDBC Driver per SQL Server consente di inviare più aggiornamenti come singola unità di lavoro, denominata anche batch." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Esecuzione di operazioni batch</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Per garantire prestazioni migliori quando si eseguono più aggiornamenti di un database di SQL Server, Microsoft JDBC Driver per SQL Server consente di inviare più aggiornamenti come singola unità di lavoro, denominata anche batch. </p><p>Le classi <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> e <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> possono essere utilizzate tutte per inviare aggiornamenti in blocco. Il metodo <a href="134f1455-c98c-4112-ab2d-9205a0db73df.htm">addBatch</a> viene utilizzato per aggiungere un comando. Il metodo <a href="6e5cda26-e24d-4637-8dfd-8135ba126e3b.htm">clearBatch</a> viene utilizzato per cancellare l'elenco dei comandi. Il metodo <a href="fb034f63-2532-4da8-a1b0-bc125734585a.htm">executeBatch</a> viene utilizzato per inviare tutti i comandi per l'elaborazione. Possono essere eseguite come parte di un batch solo le istruzioni DDL (Data Definition Language) e DML (Data Manipulation Language) che restituiscono un semplice conteggio di aggiornamento. </p><p>Il metodo <b>executeBatch</b> restituisce una matrice di valori <span sdata="langKeyword" value="int"><span class="keyword">int</span></span> che corrispondono al conteggio aggiornamenti di ogni comando. In caso di esecuzione non riuscita di uno dei comandi, viene generata un'eccezione <b>BatchUpdateException</b> ed è consigliabile utilizzare il metodo <b>getUpdateCounts</b> della classe <b>BatchUpdateException</b> per recuperare la matrice del conteggio di aggiornamento. Se un comando non riesce, il driver continua a elaborare i comandi rimanenti. Tuttavia, se un comando contiene un errore di sintassi sarà impossibile eseguire le istruzioni del batch.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se non è necessario utilizzare i conteggi degli aggiornamenti, è possibile eseguire prima un'istruzione SET NOCOUNT ON in SQL Server. Il traffico di rete verrà ridotto e aumenteranno le prestazioni dell'applicazione.</p></div><p>Come esempio viene creata la seguente tabella nel database di esempio AdventureWorks di SQL Server 2005:</p><div class="sampleCode"><span codeLanguage="other"><pre>CREATE TABLE TestTable 
   (Col1 int IDENTITY, 
    Col2 varchar(50), 
    Col3 int);</pre></span></div><p>Nell'esempio seguente viene passata alla funzione una connessione aperta al database di esempio AdventureWorks, il metodo <b>addBatch</b> viene utilizzato per creare le istruzioni da eseguire e viene eseguita la chiamata al metodo <b>executeBatch</b> per inviare il batch al database.</p><div class="sampleCode"><span codeLanguage="other"><pre>public static void executeBatchUpdate(Connection con) {
   try {
      Statement stmt = con.createStatement();
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('X', 100)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Y', 200)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Z', 300)");
      int[] updateCounts = stmt.executeBatch();
      stmt.close();
   }
   catch (Exception e) {
      e.printStackTrace();
   }
}</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">Vedere anche</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilizzo delle istruzioni con il driver JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Inviare <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/it-it/default.aspx.%0\A%0\d','Customer%20Feedback');">commenti e suggerimenti</a> su questo argomento a Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tutti i diritti sono riservati.</a></p></span></div></div></body></html>