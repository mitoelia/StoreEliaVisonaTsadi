<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilizzo delle sequenze di escape SQL</title><meta name="Language" content="it-it" /><meta name="System.Keywords" content="sequenze di escape SQL" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="Microsoft JDBC Driver per SQL Server supporta l'utilizzo di sequenze di escape SQL, in base a quanto definito dall'API JDBC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilizzo delle sequenze di escape SQL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Microsoft JDBC Driver per SQL Server supporta l'utilizzo di sequenze di escape SQL, in base a quanto definito dall'API JDBC. Le sequenze di escape vengono utilizzate all'interno di un'istruzione SQL per indicare al driver che la parte della stringa SQL per cui vengono utilizzati caratteri di escape deve essere gestita in modo diverso. Quando la parte della stringa SQL per cui vengono utilizzati caratteri di escape viene elaborata dal driver JDBC, tale parte viene tradotta in codice SQL compreso da SQL Server. </p><p>L'API JDBC richiede cinque tipi di sequenze di escape, tutti supportati dal driver JDBC:</p><ul><li><p>Valori letterali dei caratteri jolly LIKE</p></li><li><p>Gestione delle funzioni</p></li><li><p>Valori letterali data e ora</p></li><li><p>Chiamate di stored procedure</p></li><li><p>Outer join</p></li></ul><p>La sintassi della sequenza di escape utilizzata dal driver JDBC è la seguente:</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>L'elaborazione delle sequenze di escape SQL è sempre attivata per il driver JDBC.</p></div><p>Nelle sezioni seguenti vengono descritti i cinque tipi di sequenze di escape e viene illustrato in che modo sono supportati dal driver JDBC:</p></div><h1 class="heading">Valori letterali dei caratteri jolly LIKE</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Il driver JDBC supporta la sintassi <span class="code">{escape 'escape character'}</span> per l'utilizzo dei caratteri jolly della clausola LIKE come valori letterali. Il codice seguente restituisce, ad esempio, i valori per col3 se il valore di col2 inizia letteralmente con un carattere di sottolineatura (e non nel caso di utilizzo del carattere jolly).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>La sequenza di escape deve essere alla fine dell'istruzione SQL. Se vi sono più istruzioni SQL in una stringa di comando, la sequenza di escape deve essere alla fine di ogni istruzione SQL rilevante.</p></div></div><h1 class="heading">Gestione delle funzioni</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Il driver JDBC supporta le sequenze di escape delle funzioni nelle istruzioni SQL con la sintassi seguente:</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>dove <span class="code">functionName</span> è una funzione supportata dal driver JDBC. Ad esempio:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>Nella tabella seguente sono elencate le varie funzioni supportate dal driver JDBC in caso di utilizzo di una sequenza di escape delle funzioni:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Funzioni stringa</p></th><th><p>Funzioni numeriche</p></th><th><p>Funzioni data/ora</p></th><th><p>Funzioni di sistema</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCATENA</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>SINISTRA</p><p>LUNGHEZZA</p><p>LOCATE</p><p>RITAGLIAINIZIO</p><p>REPEAT</p><p>SOSTITUISCI</p><p>DESTRA</p><p>RITAGLIAFINE</p><p>SOUNDEX</p><p>SPACE</p><p>SOTTOSTRINGA</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>RESTO</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ARROTONDA</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>GIORNOSETT</p><p>GIORNOANNO</p><p>EXTRACT</p><p>ORA</p><p>MINUTO</p><p>MESE</p><p>MONTHNAME</p><p>ADESSO</p><p>TRIMESTRE</p><p>SECONDO</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>SETTIMANA</p><p>ANNO</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se si tenta di utilizzare una funzione non supportata dal database, si verifica un errore.</p></div></div><h1 class="heading">Valori letterali data e ora</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>La sintassi di escape per i valori letterali data, ora e timestamp è la seguente: </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>dove <span class="code">literal-type</span> è uno dei tipi seguenti:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Tipo di valore letterale</p></th><th><p>Descrizione</p></th><th><p>Formato del valore</p></th></tr><tr><td><p>d</p></td><td><p>Data</p></td><td><p>aaaa-mm-gg</p></td></tr><tr><td><p>t</p></td><td><p>Ora</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>TimeStamp</p></td><td><p>aaaa-mm-gg hh:mm:ss[.f...]</p></td></tr></table></div><p>Ad esempio:</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Chiamate di stored procedure</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Il driver JDBC supporta la sintassi di escape <span class="code">{? = call proc_name(?,...)}</span> e <span class="code">{call proc_name(?,...)}</span> per le chiamate di stored procedure, in base al fatto che si debba o meno elaborare un parametro restituito. </p><p>Una stored procedure è un oggetto eseguibile archiviato nel database. In genere, si tratta di una o più istruzioni SQL precompilate. La sintassi della sequenza di escape per la chiamata di un stored procedure è la seguente: </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>dove <span class="code">procedure-name</span> specifica il nome di una stored procedure e <span class="code">parameter</span> specifica un parametro della stored procedure.</p><p>Per ulteriori informazioni sull'utilizzo della sequenza di escape <span class="code">call</span> con le stored procedure, vedere <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Utilizzo delle istruzioni con le stored procedure</a></span>.</p></div><h1 class="heading">Outer join</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Il driver JDBC supporta la sintassi left, right e full outer join SQL92. La sequenza di escape per gli outer join è la seguente:</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>dove outer-join è:</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>dove <span class="code">table-reference</span> è il nome di una tabella e <span class="code">search-condition</span> è la condizione di join che si desidera utilizzare per le tabelle.</p><p>Ad esempio:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>Le sequenze di escape dell'outer join seguenti sono supportate dal driver JDBC:</p><ul><li><p>Left outer join</p></li><li><p>Right outer join</p></li><li><p>Full outer join</p></li><li><p>Outer join nidificati</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">Vedere anche</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilizzo delle istruzioni con il driver JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Inviare <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/it-it/default.aspx.%0\A%0\d','Customer%20Feedback');">commenti e suggerimenti</a> su questo argomento a Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tutti i diritti sono riservati.</a></p></span></div></div></body></html>